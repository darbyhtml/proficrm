{# –ù–µ–º–æ–¥–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞ (–±–µ–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã) #}
<div class="space-y-3" data-contact-form-root>
  <div class="flex items-start justify-between gap-3">
    <div>
      <div class="text-xs text-brand-dark/70">
        {{ company.name }}
      </div>
      <div class="text-lg font-semibold">
        {% if mode == 'edit' %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç{% else %}–ù–æ–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç{% endif %}
      </div>
    </div>
    <button type="button" class="btn btn-outline btn-sm" data-contact-panel-close title="–ó–∞–∫—Ä—ã—Ç—å" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M18 6L6 18"/><path d="M6 6l12 12"/>
      </svg>
    </button>
  </div>

  <form method="post" action="{{ action_url }}" class="space-y-4" data-contact-panel-form>
    {% csrf_token %}
    <input type="hidden" name="modal" value="1" />

    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <div>
        <label class="block text-sm text-brand-dark/80 mb-1">–§–∞–º–∏–ª–∏—è</label>
        {{ form.last_name }}
      </div>
      <div>
        <label class="block text-sm text-brand-dark/80 mb-1">–ò–º—è</label>
        {{ form.first_name }}
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <div>
        <label class="block text-sm text-brand-dark/80 mb-1">–î–æ–ª–∂–Ω–æ—Å—Ç—å</label>
        {{ form.position }}
      </div>
      <div>
        <label class="block text-sm text-brand-dark/80 mb-1">–°—Ç–∞—Ç—É—Å</label>
        {{ form.status }}
      </div>
    </div>

    <div>
      <label class="block text-sm text-brand-dark/80 mb-1">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</label>
      {{ form.note }}
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      {# Email #}
      <section>
        <div class="flex items-center justify-between gap-2 mb-2">
          <div class="font-medium">Email</div>
          <button
            type="button"
            class="btn btn-outline btn-xs"
            data-emails-add
          >
            + –î–æ–±–∞–≤–∏—Ç—å email
          </button>
        </div>
        {{ email_fs.management_form }}
        {% if email_fs.non_form_errors %}
          <div class="rounded-lg border border-brand-orange/60 bg-brand-orange/20 p-3 text-sm text-brand-dark mb-2">
            {{ email_fs.non_form_errors }}
          </div>
        {% endif %}
        <div class="space-y-2" data-emails-container>
          {% for f in email_fs %}
            {# –û–¥–∏–Ω –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ä—è–¥ email. –í—Å–µ —É–ø—Ä–∞–≤–ª—è—é—â–∏–µ –ø–æ–ª—è –æ—Å—Ç–∞–≤–ª—è–µ–º, –Ω–æ —á–µ–∫–±–æ–∫—Å DELETE –ø—Ä—è—á–µ–º –∏ —É–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ –∏–∫–æ–Ω–∫—É. #}
            <div
              class="rounded-xl border border-brand-soft bg-brand-soft/10 px-3 py-2 space-y-1"
              data-form-row="emails"
            >
              {{ f.id }}
              <div class="hidden">
                {{ f.DELETE }}
              </div>
              <div class="flex items-center justify-between gap-2">
                <div class="flex flex-wrap gap-1 text-[11px]" data-type-toggle="email">
                  <button type="button" class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full border border-transparent text-xs text-brand-dark/70 bg-transparent hover:bg-brand-soft/70" data-type-group="work">
                    <span>üè¢</span><span class="hidden sm:inline">–†–∞–±–æ—á–∏–π</span>
                  </button>
                  <button type="button" class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full border border-transparent text-xs text-brand-dark/70 bg-transparent hover:bg-brand-soft/70" data-type-group="personal">
                    <span>üë§</span><span class="hidden sm:inline">–õ–∏—á–Ω—ã–π</span>
                  </button>
                  <button type="button" class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full border border-transparent text-xs text-brand-dark/70 bg-transparent hover:bg-brand-soft/70" data-type-group="other">
                    <span>‚ãØ</span><span class="hidden sm:inline">–î—Ä—É–≥–æ–µ</span>
                  </button>
                </div>
                <button
                  type="button"
                  class="inline-flex items-center justify-center w-7 h-7 rounded-full border border-red-200 text-red-600 hover:bg-red-50 transition-colors"
                  title="–£–¥–∞–ª–∏—Ç—å email"
                  aria-label="–£–¥–∞–ª–∏—Ç—å email"
                  data-row-delete
                >
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M6 7h12M10 11v6M14 11v6M9 7l1-3h4l1 3M19 7l-1 12H6L5 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
              </div>
              <div>
                <label class="block text-xs text-brand-dark/70 mb-1">Email</label>
                <div class="hidden">
                  {{ f.type }}
                </div>
                {{ f.value }}
                {% if f.errors %}<div class="text-xs text-brand-orange mt-0.5">{{ f.errors }}</div>{% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
      </section>

      {# –¢–µ–ª–µ—Ñ–æ–Ω—ã #}
      <section>
        <div class="flex items-center justify-between gap-2 mb-2">
          <div class="font-medium">–¢–µ–ª–µ—Ñ–æ–Ω—ã</div>
          <button
            type="button"
            class="btn btn-outline btn-xs"
            data-phones-add
          >
            + –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω
          </button>
        </div>
        {{ phone_fs.management_form }}
        {% if phone_fs.non_form_errors %}
          <div class="rounded-lg border border-brand-orange/60 bg-brand-orange/20 p-3 text-sm text-brand-dark mb-2">
            {{ phone_fs.non_form_errors }}
          </div>
        {% endif %}
        <div class="space-y-2" data-phones-container>
          {% for f in phone_fs %}
            <div
              class="rounded-xl border border-brand-soft bg-brand-soft/10 px-3 py-2 space-y-1"
              data-form-row="phones"
            >
              {{ f.id }}
              <div class="hidden">
                {{ f.DELETE }}
              </div>
              <div class="flex items-center justify-between gap-2">
                <div class="flex flex-wrap gap-1 text-[11px]" data-type-toggle="phone">
                  <button type="button" class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full border border-transparent text-xs text-brand-dark/70 bg-transparent hover:bg-brand-soft/70" data-type-group="work">
                    <span>üè¢</span><span class="hidden sm:inline">–†–∞–±–æ—á–∏–π</span>
                  </button>
                  <button type="button" class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full border border-transparent text-xs text-brand-dark/70 bg-transparent hover:bg-brand-soft/70" data-type-group="personal">
                    <span>üì±</span><span class="hidden sm:inline">–õ–∏—á–Ω—ã–π</span>
                  </button>
                  <button type="button" class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full border border-transparent text-xs text-brand-dark/70 bg-transparent hover:bg-brand-soft/70" data-type-group="other">
                    <span>‚ãØ</span><span class="hidden sm:inline">–î—Ä—É–≥–æ–µ</span>
                  </button>
                </div>
                <button
                  type="button"
                  class="inline-flex items-center justify-center w-7 h-7 rounded-full border border-red-200 text-red-600 hover:bg-red-50 transition-colors"
                  title="–£–¥–∞–ª–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω"
                  aria-label="–£–¥–∞–ª–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω"
                  data-row-delete
                >
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M6 7h12M10 11v6M14 11v6M9 7l1-3h4l1 3M19 7l-1 12H6L5 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
              </div>
              <div>
                <label class="block text-xs text-brand-dark/70 mb-1">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                {{ f.type }}
                {{ f.value }}
                {% if f.errors %}<div class="text-xs text-brand-orange mt-0.5">{{ f.errors }}</div>{% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
      </section>
    </div>

    {% if form.errors %}
      <div class="rounded-lg border border-brand-orange/60 bg-brand-orange/20 p-3 text-sm text-brand-dark">
        –ü—Ä–æ–≤–µ—Ä—å –ø–æ–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–∞.
      </div>
    {% endif %}

    <div class="flex gap-2 justify-end">
      <button class="btn btn-primary" type="submit">
        {% if mode == 'edit' %}–°–æ—Ö—Ä–∞–Ω–∏—Ç—å{% else %}–°–æ–∑–¥–∞—Ç—å{% endif %}
      </button>
      <button class="btn btn-outline" type="button" data-contact-panel-close>–û—Ç–º–µ–Ω–∞</button>
    </div>
  </form>
</div>

