# –§–∏–Ω–∞–ª—å–Ω—ã–π –û—Ç—á—ë—Ç: –í—Å–µ –ó–∞–¥–∞—á–∏ –í—ã–ø–æ–ª–Ω–µ–Ω—ã

**–î–∞—Ç–∞:** 2024-01-XX  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ó–ê–î–ê–ß–ò –ó–ê–í–ï–†–®–ï–ù–´

---

## –û–±–∑–æ—Ä

–í—ã–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ 4 –∑–∞–¥–∞—á–∏:
1. ‚úÖ **–ó–∞–¥–∞—á–∞ 1:** –ü–µ—Ä–µ–¥–∞—á–∞ –∫–æ–º–ø–∞–Ω–∏–π —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –ø–æ —Ä–æ–ª—è–º + UX –º–∞—Å—Å–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–∏
2. ‚úÖ **–ó–∞–¥–∞—á–∞ 2:** –í—Ö–æ–¥ –≤ CRM —Ç–æ–ª—å–∫–æ –ø–æ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–π —Å—Å—ã–ª–∫–µ (magic link)
3. ‚úÖ **–ó–∞–¥–∞—á–∞ 3:** Android —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∫–∏
4. ‚úÖ **–ó–∞–¥–∞—á–∞ 4:** –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## –≠–¢–ê–ü B: –ó–∞–¥–∞—á–∞ 1 ‚Äî –ü–µ—Ä–µ–¥–∞—á–∞ –∫–æ–º–ø–∞–Ω–∏–π ‚úÖ

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∞–≤ –≤ `backend/companies/permissions.py`:
  - `can_transfer_company()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É –æ–¥–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏
  - `get_transfer_targets()` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π (–∏—Å–∫–ª—é—á–∞—è GROUP_MANAGER/ADMIN)
  - `can_transfer_companies()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã views –≤ `backend/ui/views.py`:
  - `company_transfer()` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤
  - `company_bulk_transfer()` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ backend
  - `company_list()` ‚Äî –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è UX
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —à–∞–±–ª–æ–Ω—ã:
  - `company_detail.html` ‚Äî –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –ø–æ —Ñ–∏–ª–∏–∞–ª–∞–º
  - `company_list.html` ‚Äî disabled –∫–Ω–æ–ø–∫–∞ —Å tooltip –¥–ª—è –Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π
- ‚úÖ –ù–∞–ø–∏—Å–∞–Ω—ã —Ç–µ—Å—Ç—ã: `backend/companies/tests_transfer.py` (15 —Ç–µ—Å—Ç–æ–≤)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `docs/COMPANY_TRANSFER_RULES.md` ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- `docs/STAGE_B_PROGRESS.md` ‚Äî –æ—Ç—á—ë—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏

---

## –≠–¢–ê–ü C: –ó–∞–¥–∞—á–∞ 2 ‚Äî Magic Link Auth ‚úÖ

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–æ–¥–µ–ª—å `MagicLinkToken` –≤ `backend/accounts/models.py`
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã endpoints:
  - `/auth/magic/<token>/` ‚Äî –≤—Ö–æ–¥ –ø–æ —Ç–æ–∫–µ–Ω—É
  - `/settings/users/<user_id>/magic-link/generate/` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞)
- ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω `SecureLoginView` ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ password login
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —à–∞–±–ª–æ–Ω—ã:
  - `login.html` ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—Ö–æ–¥–µ —Ç–æ–ª—å–∫–æ –ø–æ —Å—Å—ã–ª–∫–µ
  - `user_form.html` ‚Äî UI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Å—ã–ª–∫–∏
  - `magic_link_error.html` ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—à–∏–±–∫–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è: `0005_magic_link_token.py`
- ‚úÖ –ù–∞–ø–∏—Å–∞–Ω—ã —Ç–µ—Å—Ç—ã: `backend/accounts/tests_magic_link.py` (10+ —Ç–µ—Å—Ç–æ–≤)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `docs/MAGIC_LINK_AUTH.md` ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ø—Ä–∞–≤–∏–ª–∞
- `docs/STAGE_C_TASK2_COMPLETION.md` ‚Äî –æ—Ç—á—ë—Ç –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏

---

## –≠–¢–ê–ü D: –ó–∞–¥–∞—á–∞ 3 ‚Äî Android —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ‚úÖ

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
- ‚úÖ –ê–Ω–∞–ª–∏–∑ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
  - Polling –º–µ—Ö–∞–Ω–∏–∑–º ‚Äî —Ö–æ—Ä–æ—à–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω (–∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞)
  - PhoneNumberNormalizer ‚Äî –±–∞–∑–æ–≤–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å
  - CallLogObserverManager ‚Äî —Ö–æ—Ä–æ—à–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (ContentObserver + retry)
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- ‚úÖ –°–æ–∑–¥–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `docs/ANDROID_CALL_RELIABILITY_RECOMMENDATIONS.md` ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ P0/P1/P2

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
- **P0:** –£–ª—É—á—à–∏—Ç—å PhoneNumberNormalizer (–¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –¥–æ–±–∞–≤–æ—á–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤)
- **P1:** –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å Firebase Cloud Messaging –¥–ª—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **P2:** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

---

## –≠–¢–ê–ü D: –ó–∞–¥–∞—á–∞ 4 ‚Äî –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚úÖ

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
  - SQL Injection ‚Äî –∑–∞—â–∏—â–µ–Ω–æ (Django ORM)
  - XSS ‚Äî –∑–∞—â–∏—â–µ–Ω–æ (auto-escaping, CSP)
  - CSRF ‚Äî –∑–∞—â–∏—â–µ–Ω–æ (Django middleware)
  - Permission Checks ‚Äî –∑–∞—â–∏—â–µ–Ω–æ (@login_required, require_admin)
  - ‚ö†Ô∏è –£—Ç–µ—á–∫–∏ –≤ –ª–æ–≥–∞—Ö ‚Äî –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ 1 –ø—Ä–æ–±–ª–µ–º–∞
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —É—Ç–µ—á–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `mask_phone()` –≤ `backend/phonebridge/api.py`
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `PullCallView` –∏ `phone_call_create`

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `backend/phonebridge/api.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∞ `mask_phone()`, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- `backend/ui/views.py` ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `docs/CRITICAL_SECURITY_FIXES.md` ‚Äî –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## –°–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### Backend:
1. `backend/companies/permissions.py` ‚Äî –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∞–≤
2. `backend/ui/views.py` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω—ã views –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∫–æ–º–ø–∞–Ω–∏–π –∏ magic link
3. `backend/accounts/models.py` ‚Äî –º–æ–¥–µ–ª—å `MagicLinkToken`
4. `backend/accounts/views.py` ‚Äî endpoint –≤—Ö–æ–¥–∞ –ø–æ magic link
5. `backend/phonebridge/api.py` ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ª–æ–≥–∞—Ö
6. `backend/crm/urls.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω URL –¥–ª—è magic link
7. `backend/ui/urls.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω URL –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ magic link
8. `backend/crm/settings.py` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `MAGIC_LINK_ONLY`

### Templates:
1. `backend/templates/ui/company_detail.html` ‚Äî –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
2. `backend/templates/ui/company_list.html` ‚Äî disabled –∫–Ω–æ–ø–∫–∞ —Å tooltip
3. `backend/templates/ui/settings/user_form.html` ‚Äî UI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ magic link
4. `backend/templates/registration/login.html` ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—Ö–æ–¥–µ —Ç–æ–ª—å–∫–æ –ø–æ —Å—Å—ã–ª–∫–µ
5. `backend/templates/registration/magic_link_error.html` ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—à–∏–±–∫–∏

### Migrations:
1. `backend/accounts/migrations/0005_magic_link_token.py` ‚Äî –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è MagicLinkToken

### Tests:
1. `backend/companies/tests_transfer.py` ‚Äî —Ç–µ—Å—Ç—ã –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∫–æ–º–ø–∞–Ω–∏–π (15 —Ç–µ—Å—Ç–æ–≤)
2. `backend/accounts/tests_magic_link.py` ‚Äî —Ç–µ—Å—Ç—ã –¥–ª—è magic link (10+ —Ç–µ—Å—Ç–æ–≤)

### Documentation:
1. `docs/COMPANY_TRANSFER_RULES.md` ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–¥–∞—á–∏ –∫–æ–º–ø–∞–Ω–∏–π
2. `docs/MAGIC_LINK_AUTH.md` ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ magic link
3. `docs/ANDROID_CALL_RELIABILITY_RECOMMENDATIONS.md` ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è Android
4. `docs/CRITICAL_SECURITY_FIXES.md` ‚Äî –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
5. `docs/STAGE_B_PROGRESS.md` ‚Äî –æ—Ç—á—ë—Ç –ø–æ –∑–∞–¥–∞—á–µ 1
6. `docs/STAGE_C_TASK2_COMPLETION.md` ‚Äî –æ—Ç—á—ë—Ç –ø–æ –∑–∞–¥–∞—á–µ 2
7. `docs/STAGE_D_TASKS3_4_COMPLETION.md` ‚Äî –æ—Ç—á—ë—Ç –ø–æ –∑–∞–¥–∞—á–∞–º 3 –∏ 4

---

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### –ó–∞–¥–∞—á–∞ 1 (–ü–µ—Ä–µ–¥–∞—á–∞ –∫–æ–º–ø–∞–Ω–∏–π):
1. –í–æ–π—Ç–∏ –∫–∞–∫ –º–µ–Ω–µ–¥–∂–µ—Ä
2. –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É —Å–≤–æ–µ–π –∫–æ–º–ø–∞–Ω–∏–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ "–ü–µ—Ä–µ–¥–∞—Ç—å" –≤–∏–¥–Ω–∞
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–∏ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —Ñ–∏–ª–∏–∞–ª–∞–º
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ GROUP_MANAGER –∏ ADMIN –Ω–µ –≤ —Å–ø–∏—Å–∫–µ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
6. –í—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–ø–∞–Ω–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–ø–∏—Å–∫–∞
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ "–ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏—Ç—å" disabled, –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–µ—Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏

### –ó–∞–¥–∞—á–∞ 2 (Magic Link):
1. –í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏"
3. –û—Ç–∫—Ä—ã—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –ù–∞–∂–∞—Ç—å "üîó –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á"
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–≤–µ –≤–∫–ª–∞–¥–∫–∏: "–ö–ª—é—á –¥–æ—Å—Ç—É–ø–∞" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏ "–°—Å—ã–ª–∫–∞"
6. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞ –∏–ª–∏ —Å—Å—ã–ª–∫—É
7. –í—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
8. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
9. –í—Å—Ç–∞–≤–∏—Ç—å –∫–ª—é—á –≤ –ø–æ–ª–µ "–ö–ª—é—á –¥–æ—Å—Ç—É–ø–∞" (–≤–∫–ª–∞–¥–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
10. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à—ë–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥
11. –í—ã–π—Ç–∏ –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤–æ–π—Ç–∏ –ø–æ —Å—Å—ã–ª–∫–µ ‚Äî –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–∏–∑–æ–π—Ç–∏ –≤—Ö–æ–¥
12. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ ‚Äî –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–∞—Ä–æ–ª—å
13. –í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ –ª–æ–≥–∏–Ω—É –∏ –ø–∞—Ä–æ–ª—é (–≤–∫–ª–∞–¥–∫–∞ "–ü–æ –ª–æ–≥–∏–Ω—É –∏ –ø–∞—Ä–æ–ª—é")
14. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤–æ–π—Ç–∏ –∫–∞–∫ –Ω–µ-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ –ø–∞—Ä–æ–ª—é ‚Äî –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞

### –ó–∞–¥–∞—á–∞ 3 (Android):
1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å `docs/ANDROID_CALL_RELIABILITY_RECOMMENDATIONS.md`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ó–∞–¥–∞—á–∞ 4 (–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å):
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ ‚Äî –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω—ã
2. –ü—Ä–∏–º–µ—Ä: `PullCallView: delivered call 123 to user 456, phone ***2233`

---

## –¢–µ—Å—Ç—ã

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
cd backend

# –¢–µ—Å—Ç—ã –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∫–æ–º–ø–∞–Ω–∏–π
python manage.py test companies.tests_transfer -v 2

# –¢–µ—Å—Ç—ã –¥–ª—è magic link
python manage.py test accounts.tests_magic_link -v 2
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

---

## –†–∏—Å–∫–∏ –∏ rollback

### –ó–∞–¥–∞—á–∞ 1:
**–†–∏—Å–∫–∏:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ (—Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø—Ä–∞–≤)

**Rollback:**
```bash
git checkout HEAD~1 backend/companies/permissions.py
git checkout HEAD~1 backend/ui/views.py
git checkout HEAD~1 backend/templates/ui/company_detail.html
git checkout HEAD~1 backend/templates/ui/company_list.html
```

### –ó–∞–¥–∞—á–∞ 2:
**–†–∏—Å–∫–∏:** –ü–æ—Ç–µ—Ä—è –¥–æ—Å—Ç—É–ø–∞, –µ—Å–ª–∏ –∞–¥–º–∏–Ω –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

**Rollback:**
```bash
# –û—Ç–∫–ª—é—á–∏—Ç—å magic link only
# –í .env: MAGIC_LINK_ONLY=0

# –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
python manage.py migrate accounts 0004_user_email_signature_html
```

### –ó–∞–¥–∞—á–∞ 3:
**–†–∏—Å–∫–∏:** –ù–µ—Ç (—Ç–æ–ª—å–∫–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

### –ó–∞–¥–∞—á–∞ 4:
**–†–∏—Å–∫–∏:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ (—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è)

**Rollback:**
```bash
git checkout HEAD~1 backend/phonebridge/api.py
git checkout HEAD~1 backend/ui/views.py
```

---

## –°—Ç–∞—Ç—É—Å: ‚úÖ –í–°–ï –ó–ê–î–ê–ß–ò –ó–ê–í–ï–†–®–ï–ù–´

**–ì–æ—Ç–æ–≤–æ –∫:**
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- ‚úÖ Code review
- ‚úÖ –î–µ–ø–ª–æ—é

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–ª—É—á—à–µ–Ω–∏—è PhoneNumberNormalizer (P0)
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å Firebase Cloud Messaging (P1)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö:
- `docs/COMPANY_TRANSFER_RULES.md`
- `docs/MAGIC_LINK_AUTH.md`
- `docs/ANDROID_CALL_RELIABILITY_RECOMMENDATIONS.md`
- `docs/CRITICAL_SECURITY_FIXES.md`
