# –û—Ç—á—ë—Ç –ø–æ –∞—É–¥–∏—Ç—É –¥–µ–ø–ª–æ—è –∏ –∑–∞—â–∏—Ç–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤

**–î–∞—Ç–∞:** 2026-01-15  
**–¶–µ–ª—å:** –ê—É–¥–∏—Ç –ª–∏—à–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏ –∑–∞—â–∏—Ç–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –æ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

---

## –ó–ê–î–ê–ß–ê 1 ‚Äî –ê—É–¥–∏—Ç "–ª–∏—à–Ω–µ–≥–æ"

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ª–∏—à–Ω–∏–µ —Ñ–∞–π–ª—ã/–ø–∞–ø–∫–∏

#### A) –£–∂–µ –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ Docker —á–µ—Ä–µ–∑ `.dockerignore` ‚úÖ

- `android/` ‚Äî Android –ø—Ä–æ–µ–∫—Ç (–Ω–µ –Ω—É–∂–µ–Ω –≤ runtime)
- `**/*.jks`, `**/*.keystore` ‚Äî –∫–ª—é—á–∏ –ø–æ–¥–ø–∏—Å–∏
- `**/.gradle/`, `**/build/` ‚Äî –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–±–æ—Ä–∫–∏ Android
- `__pycache__/` ‚Äî –∫–µ—à Python
- `.pytest_cache/`, `.mypy_cache/` ‚Äî –∫–µ—à–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- `*.md` ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–∫—Ä–æ–º–µ `backend/README.md`)
- `*.log` ‚Äî –ª–æ–≥–∏
- `*.csv`, `*.xlsx` ‚Äî —ç–∫—Å–ø–æ—Ä—Ç—ã –¥–∞–Ω–Ω—ã—Ö
- –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (`count_types.py`, `debug_types*.py`, `inspect_*.py`, `scan_rows.py`)
- IDE —Ñ–∞–π–ª—ã (`.vscode/`, `.idea/`)

#### B) –ß—Ç–æ –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —É–¥–∞–ª–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–ø–æ—Å–ª–µ backup)

**–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ –¥–µ–ø–ª–æ–π-–∫–æ–ø–∏–∏ (–ù–ï –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏):**

1. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** (–µ—Å–ª–∏ –µ—Å—Ç—å):
   ```bash
   # –°–æ–∑–¥–∞—Ç—å backup
   tar -czf ~/backup_docs_$(date +%Y%m%d).tar.gz *.md docs/
   
   # –£–¥–∞–ª–∏—Ç—å (—Ç–æ–ª—å–∫–æ –≤ –¥–µ–ø–ª–æ–π-–∫–æ–ø–∏–∏, –Ω–µ –≤ git!)
   rm -f *.md
   rm -rf docs/
   ```

2. **–ö–µ—à–∏ Python** (–µ—Å–ª–∏ –µ—Å—Ç—å):
   ```bash
   find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null
   find . -type d -name ".pytest_cache" -exec rm -rf {} + 2>/dev/null
   ```

3. **–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã Android** (–µ—Å–ª–∏ –µ—Å—Ç—å):
   ```bash
   rm -rf android/CRMProfiDialer/.gradle/
   rm -rf android/CRMProfiDialer/build/
   rm -rf android/CRMProfiDialer/app/build/
   ```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –£–¥–∞–ª—è—Ç—å –¢–û–õ–¨–ö–û –≤ –¥–µ–ø–ª–æ–π-–∫–æ–ø–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ù–ï –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏!

---

## –ó–ê–î–ê–ß–ê 2 ‚Äî "–£–¥–∞–ª–∏—Ç—å md —Ñ–∞–π–ª—ã"

### –†–µ—à–µ–Ω–∏–µ

‚úÖ **`.dockerignore` —É–∂–µ –∏—Å–∫–ª—é—á–∞–µ—Ç `*.md`** (–∫—Ä–æ–º–µ `backend/README.md`)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- `*.md` —Ñ–∞–π–ª—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ Docker build context
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ—Å—Ç–∞—ë—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (–¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å `.md` —Ñ–∞–π–ª—ã –∏–∑ –¥–µ–ø–ª–æ–π-–∫–æ–ø–∏–∏ (–ø–æ—Å–ª–µ backup)

**–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞:**
```bash
# 1. Backup
cd /opt/crm-staging
tar -czf ~/backup_md_files_$(date +%Y%m%d).tar.gz *.md docs/

# 2. –£–¥–∞–ª–∏—Ç—å (—Ç–æ–ª—å–∫–æ –≤ –¥–µ–ø–ª–æ–π-–∫–æ–ø–∏–∏)
rm -f *.md
rm -rf docs/

# 3. Smoke test
docker compose -f docker-compose.staging.yml restart web
curl http://localhost/health/
```

---

## –ó–ê–î–ê–ß–ê 3 ‚Äî –ù–µ –ø–µ—Ä–µ–∑–∞—Ç–∏—Ä–∞—Ç—å "—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏/–Ω–∞—Å—Ç—Ä–æ–π–∫–∏" –ø—Ä–∏ git pull

### ‚úÖ –•–û–†–û–®–ò–ï –ù–û–í–û–°–¢–ò: –ü—Ä–æ–±–ª–µ–º—ã –ù–ï–¢!

**–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î, –ù–ï –≤ —Ñ–∞–π–ª–∞—Ö:**

1. **–ú–æ–¥–µ–ª–∏ Django (–≤ –ë–î):**
   - `CompanyStatus` ‚Äî —Å—Ç–∞—Ç—É—Å—ã –∫–æ–º–ø–∞–Ω–∏–π
   - `CompanySphere` ‚Äî —Å—Ñ–µ—Ä—ã –∫–æ–º–ø–∞–Ω–∏–π
   - `TaskType` ‚Äî —Ç–∏–ø—ã –∑–∞–¥–∞—á
   - `UiGlobalConfig` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ UI
   - `AmoApiConfig` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ amoCRM

2. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ UI:**
   - –†–∞–∑–¥–µ–ª "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏"
   - –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
   - `git pull` **–ù–ï –¢–†–û–ì–ê–ï–¢** –¥–∞–Ω–Ω—ã–µ –≤ –ë–î

3. **–ù–µ—Ç fixtures —Ñ–∞–π–ª–æ–≤:**
   - –ù–µ—Ç `fixtures/*.json` –∏–ª–∏ `fixtures/*.yaml`
   - –ù–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –∏–∑ —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

### –í—ã–≤–æ–¥

**–ù–∏–∫–∞–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!** –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —É–∂–µ –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ –≤ —Ñ–∞–π–ª–∞—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.

### –ö–∞–∫ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ "–ø–æ –ø—Ä–∞–≤–∏–ª–∞–º"

1. **–ß–µ—Ä–µ–∑ UI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
   - –í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
   - –ü–µ—Ä–µ–π—Ç–∏ –≤ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏"
   - –î–æ–±–∞–≤–∏—Ç—å/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å–∏

2. **–ß–µ—Ä–µ–∑ Django admin (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):**
   ```bash
   docker compose -f docker-compose.staging.yml exec web python manage.py shell
   ```
   ```python
   from companies.models import CompanyStatus, CompanySphere
   from tasksapp.models import TaskType
   
   # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å
   CompanyStatus.objects.create(name="–ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å")
   ```

3. **–ß–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π):**
   - –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ –≤ –º–æ–¥–µ–ª—å ‚Äî —Å–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
   - –î–∞–Ω–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –º–∏–≥—Ä–∞—Ü–∏–∏ –ù–ï —Ç—Ä–æ–≥–∞—é—Ç

---

## –ó–ê–î–ê–ß–ê 4 ‚Äî –£–ª—É—á—à–µ–Ω–∏—è .dockerignore

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

`.dockerignore` —É–∂–µ —Ö–æ—Ä–æ—à–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –∏—Å–∫–ª—é—á–∞–µ—Ç:
- Android –ø—Ä–æ–µ–∫—Ç
- –ö–µ—à–∏ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
- IDE —Ñ–∞–π–ª—ã

### –ù–µ–±–æ–ª—å—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

–î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –ø–æ–ª–Ω–æ—Ç—ã:
- `node_modules/` (–Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è frontend)
- `.DS_Store` (macOS)
- `*.swp`, `*.swo` (Vim)

---

## –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

1. –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –≤ –ë–î ‚Äî –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏
2. `.dockerignore` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∞ –∏–∑ Docker images

### üìù –ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. –£–¥–∞–ª–∏—Ç—å `.md` —Ñ–∞–π–ª—ã –∏–∑ –¥–µ–ø–ª–æ–π-–∫–æ–ø–∏–∏ (–ø–æ—Å–ª–µ backup)
2. –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à–∏ Python (–µ—Å–ª–∏ –µ—Å—Ç—å)
3. –£–¥–∞–ª–∏—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã Android (–µ—Å–ª–∏ –µ—Å—Ç—å)

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∑–∞—â–∏—â–µ–Ω—ã (–≤ –ë–î)
- –°–µ–∫—Ä–µ—Ç—ã –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ Docker images (`.env`, `*.jks`, `*.keystore` –∏—Å–∫–ª—é—á–µ–Ω—ã)
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ runtime

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Docker build –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç –ª–∏—à–Ω–µ–µ
docker build -f Dockerfile.staging -t crm-test .
docker run --rm crm-test find /app -name "*.md" | grep -v README.md
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ (–∏–ª–∏ —Ç–æ–ª—å–∫–æ backend/README.md)

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health endpoint
curl http://localhost/health/

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
# –í–æ–π—Ç–∏ –≤ CRM ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –º–µ—Å—Ç–µ
```

---

**–í—ã–≤–æ–¥:** –°–∏—Å—Ç–µ–º–∞ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∑–∞—â–∏—â–µ–Ω—ã, –ª–∏—à–Ω–∏–µ —Ñ–∞–π–ª—ã –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ Docker. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
