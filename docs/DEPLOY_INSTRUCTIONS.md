# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤

## üéØ –ì–ª–∞–≤–Ω—ã–π –≤—ã–≤–æ–¥

**–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏!** –û–Ω–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ –≤ —Ñ–∞–π–ª–∞—Ö, –ø–æ—ç—Ç–æ–º—É `git pull` –∏—Ö –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç.

---

## üìã –ö–∞–∫ –¥–µ–ø–ª–æ–∏—Ç—å

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –¥–µ–ø–ª–æ–π (staging)

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /opt/crm-staging

# 1. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
git pull

# 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
docker compose -f docker-compose.staging.yml exec web python manage.py migrate

# 3. –°–æ–±—Ä–∞—Ç—å —Å—Ç–∞—Ç–∏–∫—É (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å CSS/JS)
docker compose -f docker-compose.staging.yml exec web python manage.py collectstatic --noinput

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose -f docker-compose.staging.yml restart web

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
curl http://localhost/health/
```

### –ß—Ç–æ –ù–ï –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

‚úÖ **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (–≤ –ë–î):**
- –°—Ç–∞—Ç—É—Å—ã –∫–æ–º–ø–∞–Ω–∏–π (`CompanyStatus`)
- –°—Ñ–µ—Ä—ã –∫–æ–º–ø–∞–Ω–∏–π (`CompanySphere`)
- –¢–∏–ø—ã –∑–∞–¥–∞—á (`TaskType`)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ UI (`UiGlobalConfig`)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ amoCRM (`AmoApiConfig`)

‚úÖ **–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ–º–ø–∞–Ω–∏–π, –∑–∞–¥–∞—á** (–≤—Å—ë –≤ –ë–î)

‚úÖ **Media —Ñ–∞–π–ª—ã** (–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ UI)

---

## üîß –ö–∞–∫ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ UI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –í–æ–π—Ç–∏ –≤ CRM –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏"** ‚Üí **"–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏"**
3. –î–æ–±–∞–≤–∏—Ç—å/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å–∏
4. –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î —Å—Ä–∞–∑—É

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ Django admin

```bash
# –í–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É
http://your-domain/admin/

# –ò–ª–∏ —á–µ—Ä–µ–∑ shell
docker compose -f docker-compose.staging.yml exec web python manage.py shell
```

```python
from companies.models import CompanyStatus, CompanySphere
from tasksapp.models import TaskType

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å
CompanyStatus.objects.create(name="–ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å")

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å—Ñ–µ—Ä—É
CompanySphere.objects.create(name="–ù–æ–≤–∞—è —Å—Ñ–µ—Ä–∞")

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø –∑–∞–¥–∞—á–∏
TaskType.objects.create(name="–ù–æ–≤—ã–π —Ç–∏–ø", icon="phone", color="blue")
```

### –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π)

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ –≤ –º–æ–¥–µ–ª—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞:

```bash
# –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
docker compose -f docker-compose.staging.yml exec web python manage.py makemigrations

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
docker compose -f docker-compose.staging.yml exec web python manage.py migrate
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏–∑–º–µ–Ω—è—é—Ç —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü, –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ç—Ä–æ–≥–∞—é—Ç!

---

## üßπ –û—á–∏—Å—Ç–∫–∞ –ª–∏—à–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£–¥–∞–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–∑ –¥–µ–ø–ª–æ–π-–∫–æ–ø–∏–∏

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (—Ç–æ–ª—å–∫–æ –≤ –¥–µ–ø–ª–æ–π-–∫–æ–ø–∏–∏, –ù–ï –≤ git!)
cd /opt/crm-staging

# 1. –°–æ–∑–¥–∞—Ç—å backup
tar -czf ~/backup_md_files_$(date +%Y%m%d).tar.gz *.md docs/ 2>/dev/null || true

# 2. –£–¥–∞–ª–∏—Ç—å (—Ç–æ–ª—å–∫–æ –≤ –¥–µ–ø–ª–æ–π-–∫–æ–ø–∏–∏)
rm -f *.md
rm -rf docs/

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
docker compose -f docker-compose.staging.yml restart web
curl http://localhost/health/
```

### –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–µ–π Python

```bash
# –ù–∞–π—Ç–∏ –∏ —É–¥–∞–ª–∏—Ç—å __pycache__
find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null || true
find . -type d -name ".pytest_cache" -exec rm -rf {} + 2>/dev/null || true
```

### –û—á–∏—Å—Ç–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ Android (–µ—Å–ª–∏ –µ—Å—Ç—å)

```bash
# –£–¥–∞–ª–∏—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–±–æ—Ä–∫–∏ Android
rm -rf android/CRMProfiDialer/.gradle/
rm -rf android/CRMProfiDialer/build/
rm -rf android/CRMProfiDialer/app/build/
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –£–¥–∞–ª—è—Ç—å –¢–û–õ–¨–ö–û –≤ –¥–µ–ø–ª–æ–π-–∫–æ–ø–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ù–ï –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏!

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. Health check

```bash
curl http://localhost/health/
# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {"status": "ok"}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

1. –í–æ–π—Ç–∏ –≤ CRM
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ **"–ù–∞—Å—Ç—Ä–æ–π–∫–∏"** ‚Üí **"–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏"**
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –º–µ—Å—Ç–µ
4. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–æ–±–∞–≤–∏—Ç—å/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Docker image –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏—à–Ω–µ–≥–æ

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ .md —Ñ–∞–π–ª—ã –Ω–µ –ø–æ–ø–∞–ª–∏ –≤ –æ–±—Ä–∞–∑
docker run --rm crm_staging_web find /app -name "*.md" | grep -v README.md
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É—Å—Ç–æ (–∏–ª–∏ —Ç–æ–ª—å–∫–æ backend/README.md)
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ —É–∂–µ –∑–∞—â–∏—â–µ–Ω–æ

‚úÖ **–°–µ–∫—Ä–µ—Ç—ã:**
- `.env` —Ñ–∞–π–ª—ã –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ Docker
- `*.jks`, `*.keystore` –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ Docker
- –ü–∞—Ä–æ–ª–∏ –∏ —Ç–æ–∫–µ–Ω—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

‚úÖ **–î–∞–Ω–Ω—ã–µ:**
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –≤ –ë–î (–Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è)
- Media —Ñ–∞–π–ª—ã –≤ volume (–Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è)
- –°—Ç–∞—Ç–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ

‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- `.md` —Ñ–∞–π–ª—ã –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ Docker images
- –û—Å—Ç–∞—é—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏

---

## üìù –†–µ–∑—é–º–µ

1. **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∑–∞—â–∏—â–µ–Ω—ã** ‚Äî –æ–Ω–∏ –≤ –ë–î, `git pull` –∏—Ö –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç
2. **–î–µ–ø–ª–æ–π –±–µ–∑–æ–ø–∞—Å–µ–Ω** ‚Äî –ª–∏—à–Ω–∏–µ —Ñ–∞–π–ª—ã –∏—Å–∫–ª—é—á–µ–Ω—ã —á–µ—Ä–µ–∑ `.dockerignore`
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤** ‚Äî —á–µ—Ä–µ–∑ UI –∏–ª–∏ Django admin
4. **–û—á–∏—Å—Ç–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞, —Ç–æ–ª—å–∫–æ –≤ –¥–µ–ø–ª–æ–π-–∫–æ–ø–∏–∏

**–ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!** –°–∏—Å—Ç–µ–º–∞ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ.
